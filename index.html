<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Survival Dodge Game with Levels and Bosses</title>
  <style>
    body { margin: 0; overflow: hidden; background: #111; }
    canvas { display: block; background: #000; }
    #ui {
      position: absolute;
      top: 10px;
      left: 10px;
      color: white;
      font-family: sans-serif;
      font-size: 20px;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="ui">Score: 0 | Time Left: 600 | Level: 1 | Boss: No</div>
  <canvas id="game"></canvas>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let player = {
      x: canvas.width / 2,
      y: canvas.height - 30,
      size: 30,
      speed: 5,
      color: '#00BFFF'
    };

    let obstacles = [];
    let score = 0;
    let level = 1;
    let timeLeft = 600; // 10 minutes in seconds
    let gameOver = false;
    let lastTime = Date.now();
    let ballsDropped = 0;
    let isBossLevel = false;

    // Movement controls
    let keys = {};
    document.addEventListener('keydown', (e) => keys[e.key.toLowerCase()] = true);
    document.addEventListener('keyup', (e) => keys[e.key.toLowerCase()] = false);

    // Boss setup
    let boss = null;
    let bossHealth = 0;

    function generateObstacle() {
      const size = Math.random() * 30 + 20;
      const x = Math.random() * (canvas.width - size);
      obstacles.push({
        x: x,
        y: -size,
        size: size,
        speed: Math.random() * 2 + 1 + level * 0.5
      });
      ballsDropped++;
    }

    function generateBoss() {
      isBossLevel = true;
      const size = 100 + level * 2;
      const x = Math.random() * (canvas.width - size);
      boss = {
        x: x,
        y: -size,
        size: size,
        speed: Math.random() * 1 + 0.5 + level * 0.2,
      };
      bossHealth = level * 3; // Boss's health increases with levels
    }

    function update() {
      // Timer logic
      const now = Date.now();
      const deltaTime = (now - lastTime) / 1000; // seconds
      lastTime = now;

      if (timeLeft > 0) timeLeft -= deltaTime;
      if (timeLeft <= 0 && !gameOver) {
        gameOver = true;
        alert(`Game Over! You survived for 10 minutes. Your score: ${score}`);
      }

      // Player movement
      if (keys['w'] || keys['arrowup']) player.y -= player.speed;
      if (keys['s'] || keys['arrowdown']) player.y += player.speed;
      if (keys['a'] || keys['arrowleft']) player.x -= player.speed;
      if (keys['d'] || keys['arrowright']) player.x += player.speed;

      // Boundaries for player
      player.x = Math.max(player.size / 2, Math.min(canvas.width - player.size / 2, player.x));
      player.y = Math.max(player.size / 2, Math.min(canvas.height - player.size / 2, player.y));

      // Generate obstacles based on time and level
      if (Math.random() < 0.02 * level && !isBossLevel) {
        generateObstacle();
      }

      // Generate boss for the level
      if (ballsDropped >= 20 && !isBossLevel && (level % 10 === 0 || level === 100)) {
        generateBoss();
      }

      // Move obstacles
      obstacles.forEach((obstacle, index) => {
        obstacle.y += obstacle.speed;
        if (obstacle.y > canvas.height) {
          obstacles.splice(index, 1);
          score++;
        }

        // Collision detection with player
        const dist = Math.hypot(obstacle.x - player.x, obstacle.y - player.y);
        if (dist < (obstacle.size + player.size) / 2) {
          gameOver = true;
          alert(`Game Over! You collided with an obstacle. Your score: ${score}`);
        }
      });

      // Boss moves and collision detection
      if (boss) {
        boss.y += boss.speed;
        const distToBoss = Math.hypot(boss.x - player.x, boss.y - player.y);
        if (distToBoss < (boss.size + player.size) / 2) {
          gameOver = true;
          alert(`Game Over! You collided with the boss. Your score: ${score}`);
        }

        // Boss health decrease (for future mechanic)
        if (distToBoss < (boss.size + player.size) / 2 && bossHealth > 0) {
          bossHealth--;
        }
        if (boss.y > canvas.height) {
          boss = null;
          isBossLevel = false;
        }
      }

      // Increase level and difficulty every 20 balls
      if (ballsDropped >= 20 * level) {
        level++;
        ballsDropped = 0;
      }
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw player
      ctx.fillStyle = player.color;
      ctx.beginPath();
      ctx.arc(player.x, player.y, player.size / 2, 0, Math.PI * 2);
      ctx.fill();

      // Draw obstacles
      ctx.fillStyle = 'red';
      obstacles.forEach((obstacle) => {
        ctx.beginPath();
        ctx.arc(obstacle.x, obstacle.y, obstacle.size / 2, 0, Math.PI * 2);
        ctx.fill();
      });

      // Draw boss
      if (boss) {
        ctx.fillStyle = 'orange';
        ctx.beginPath();
        ctx.arc(boss.x, boss.y, boss.size / 2, 0, Math.PI * 2);
        ctx.fill();
      }

      // Update UI
      document.getElementById('ui').textContent = `Score: ${score} | Time Left: ${Math.round(timeLeft)} | Level: ${level} | Boss: ${isBossLevel ? 'Yes' : 'No'}`;
    }

    // Main game loop
    function gameLoop() {
      if (!gameOver) {
        update();
        draw();
        requestAnimationFrame(gameLoop);
      }
    }

    // Start the game
    gameLoop();
  </script>
</body>
</html>
